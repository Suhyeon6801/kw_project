{% extends 'base.html' %}

{% block content %}
<style>
    .graph_box {
    -webkit-box-flex: 1;
    -ms-flex: 1 1 auto;
    flex: 1 1 auto;
    padding: 1.25rem;
    }

</style>
    <div class="container-fluid"> 
        <ol class="breadcrumb">
            <li class="breadcrumb-item active"><center>You can check the exchange rate of the dollar and the won for the last three months.</center></li>
            </ol>
        <div class="card-header">
            <i class="fas fa-chart-area"></i>
             Today's Exhange Rate</div>
            <div class="card mb-3">
                <div class="graph_box">
                    <canvas id="chart" height="70" width="=100%"></canvas>
                    <!---<div><button onclick="GetChart()">오늘의 환율 가져오기</button></div>-->
                </div>
                <div class="card-footer small text-muted">Updated yesterday at 11:59 PM</div>
            </div>
    </div>
    <script>

        const url = "api/graph/data";

        function test1(){
            console.log('hi');
        }
        
        function GetChart(){

            $.ajax({
                method : "GET",
                url : url,
                

                success:function(chartdata){
                    labels=chartdata.x_usd;
                    y_usd=chartdata.y_usd;
                    x_jpy=chartdata.x_jpy;
                    y_jpy=chartdata.y_jpy;

                    PaintChart();
                },
                error:function(error_data){
                    console.log("error");
                    console.log(error_data);
                }
            })
        }
        GetChart();

        function PaintChart(){
            const colors = ['#007bff','#28a745','#333333','#c3e6cb','#dc3545','#6c757d'];
            const chart = document.getElementById("chart")

            const chartData = {//차트데이터
                labels: labels,
                datasets: [
                    {//usd
                    label: "USD",
                    data: y_usd,
                    backgroundColor: 'transparent',
                    borderColor: colors[0], //파랑
                    borderWidth: 4,
                    pointBackgroundColor: colors[0]
                    },
                    {//jpy
                    label: "JPY",
                    data: y_jpy,
                    backgroundColor: 'transparent',
                    borderColor: colors[1], //초록
                    borderWidth: 5,
                    pointBackgroundColor: colors[1]
                    }
                ]
            };


            var myLineChart = new Chart(chart, {
                type: 'line',
                data: chartData,
                options: {
                //showLines:false,
                scales: {
                    yAxes: [{
                        ticks: {
                        beginAtZero: false
                        }
                    }]
                },
                legend: {//범례 지정하고싶다면 true
                    display: false
                }
                }
            });
        }
    </script>>
{% endblock %}

